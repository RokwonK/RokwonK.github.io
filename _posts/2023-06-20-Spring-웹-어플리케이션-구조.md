---
title: "Spring 웹 어플리케이션의 구조"
categories: Spring
tags:
  - IoC
---  

Spring 웹 어플리케이션이 동작하는 과정에 대해서 알아보자.

## WAS
WAS(Web Application Server)는 Spring에서 요청을 처음 받아들이는 프로그램이다.
- 대부분의 WAS가 Web Server의 기능을 내장하고 있어 HTTP 요청을 처리할 수 있다.
- 동적인 컨텐츠를 생성하고 제공하기 위해 만들어진 프로그램(요청 인자에 따라 컨텐츠가 바뀔 수 있다.)
- 사실상 웹서버로 동작중인 Apache가 요청을 처음받고 동적 데이터 처리를 위해 WAS에게 요청을 넘긴다.
- DB 조회 등 다양한 비즈니스 로직들이 존재한다.  

<br /><br />

## Servlet Container
WAS는 Spring에서 Servlet Container(서블릿 컨테이너)라고 불린다. 
- 서블릿 컨테이너 위에서 다양한 서블릿들이 동작하며, 클라이언트의 요청들을 서블릿에 매핑시켜준다. 
- 서블릿의 생명주기를 담당한다.
- 스레드 풀 관리, 데이터베이스 커넥션 풀 관리, 트랜잭션 관리 등 로우한 수준의 관리를 담당한다.
- Tomcat, Jetty, JBoss 등이 존재  

<br />  

### WAS의 멀티 스레드 관리방식
Java 기반의 프로그램들은 요청을 멀티쓰레드 방식으로 처리함. 멀티 쓰레드는 동시접근, 쓰레드 생성과 같은 문제가 존재하는데 이러한 문제들을 어떻게 관리할까?

- 스레드 풀 - 쓰레드 생성 비용 줄이기
- 스레드 동기화 - 공유 데이터에 대한 동기화(synchronized, lock 객체, Thread-safe한 자료구조 사용)
- 스레드 지연 - 과도한 요청 시 요청을 대기, 스레드 풀을 동적 조절
- 스레드 로컬 - 각 스레드의 고유한 데이터 저장(스레드가 자체적인 데이터를 유지하며 동시에 다른 스레드와 독립적으로 작업 수행)

<br />

### 왜 Tomcat인가
- 경랑 - 필요한 기능만을 가지고 있어 가볍다
- 오픈소스(안정성, 신뢰성) - 검증되어 있으며 지속적인 개선이 이루어짐
- 확장성 - 다른 모듈과 함께 사용가능
- 유연성 - 단독실행, 다른 WAS와 함께 실행 가능

<br /><br />  

## Spring Web MVC
Spring Web MVC는 모든 요청을 하나의 서블릿에서 받아 공통로직 처리 후 알맞은 핸들러로 보내는 Front Controller 패턴을 이용한다.
1. 핸들러 매핑 정보 조회 - 핸들러 존재하는지 조회
2. 핸들러 어댑터 - 해당 핸들러를 처리할 수 있는 어댑터 가져오기
3. 어뎁터에 요청 전달 - 핸들러가 데이터 처리 후 ModelAndView 반환
4. 뷰 리졸버 - 뷰 만들기
5. 응답 - 클라이언트에 응답

<br /><br />  

## Servlet들

### Default Servlet
요청에 대한 패턴을 가진 서블릿이 없을때 요청을 받는 서블릿  

<br />  

### DispatchServlet
Web MVC에서 요청을 받아 공통 로직을 처리하고 반환하는 서블릿  

<br />  

### Filter Servlet
다른 서블릿으로 가기전 가장 먼저 요청을 받아 필터링하는 서블릿  

<br /><br />  

## Spring Container와 데이터 주입  



<br /><br />  

## Spring 빌드부터 동작까지