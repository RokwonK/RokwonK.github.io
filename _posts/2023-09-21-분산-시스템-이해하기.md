---  
title: "분산 시스템 이해하기"
categories: Software
tags:
  - system
---  

근래 MSA, 쿠버네티스, 카프카 등 대규모 서비스에서 사용되는 여러가지 기술들에 대해 눈으로 보고 귀를 듣는 경우가 많아졌다. 꽤나 예전부터 학습하고자 하는 마음에 관련 포스트들을 북마크에 쟁여 놓고 있었는데 일련의 경험이 트리거가 되어 드디어 그 보따리를 풀게 되었다. 먼저, 이것들의 바탕이 되는 분산 시스템의 개념에 대해서 이해해보자.

### 분산 시스템이란?

> A collection of independent computers that appear to its users as one computer
> *- Andrew Tanenbaum -*

분산 컴퓨터 시스템(혹은 클러스터 컴퓨터 시스템)은 사용자의 입장에서 하나의 컴퓨터가 동작하는것처럼 보여지지만, 실제로는 **여러개의 독립적인 컴퓨터(노드)가 네트워크를 통해 연결되어 작동하는 시스템을 의미**{: .font-highlight}한다. 필요하다면 여러 노드가 메세지를 통해 협력하여 작업을 수행한다.

분산 시스템은 확장성, 가용성, 성능 향상 등을 목표로 여러 노드가 협력하는 모든 개념을 포함한다. 
- 대용량의 데이터를 안전하게 저장하고 빠르게 읽기 위해 여러 데이터베이스에 데이터를 분산 저장하고 동기화하는 시스템
- 장애 내구성을 높이고 부분별 확장성을 위해 큰 역할을 작은 역할로 분할하고 각 역할을 맡은 노드들이 협력하여 작업을 수행하는 시스템
- 성능향상을 위해 쓰기 데이터베이스와 읽기 데이터베이스를 나누어 관리하는 시스템  

<br />  

### 분산 시스템이 가지는 특징
분산 시스템에는 3가지 대표적인 특징이 있다.
1. 분산 시스템의 각 노드들은 병렬적으로 실행된다.  
2. 분산 시스템에서 각 노드에서의 실패는 독립적인 문제여야 한다.  
	하나의 노드에서 문제가 생겨도 다른 노드에 영향을 미치지 않는다.
3. Global clock을 가질 수 없다.
	분산 시스템에 각 노드들은 네트워크 상에서 메시지로 통신한다. 하지만 네트워크 통신에는 지연이 존재하기 때문에 완전히 시간을 동기화할 수 없다. 이로 인해 이벤트의 발생 순서를 정확히 알기 힘들다.

<br />  

### 분산 시스템 개념을 적용한 서비스들
컴퓨터 인프라에는 여러가지 시스템들이 존재한다. 웹 서버부터 데이터베이스, 메세지 큐 등 특정 역할을 하는 다양한 시스템들을 우리는 필요에 따라 사용하고 있다. 그리고 당연하게도 이러한 특정 역할을 하는 서비스들은 모두 각각 분산 시스템으로 구성될 수 있다. 

- 분산 컴퓨팅 시스템 - Kubernetes
- 분산 데이터베이스(스토리지) 시스템 - Redis Cluster
- 분산 파일 시스템 - HDFS
- 분산 네트워크 시스템 - CDN
- 분산 메시징 시스템 - Kafka


### 분산시스템에서 발생 가능한 문제
분산 시스템은 노드들을 물리적으로 여러 시스템으로 나누었기에 각 노드들은 필연적으로 데이터를 주고받는 과정이 필요하다. 노드들은 **네트워크를 통해 상호 작용을 하기 때문에 이로 인해 여러가지 문제와 도전 과제가 발생**한다.

1. **통신 문제**  
분산 시스템의 핵심은 노드 간의 통신입니다. 네트워크 장애, 패킷 손실, 지연 등과 같은 통신 문제는 시스템의 가용성과 신뢰성에 영향을 미칩니다.
2. **일관성과 가용성 문제**  
CAP 이론에 따라 분산 시스템에서 일관성, 가용성, 분할 허용성을 균형 있게 유지하는 것은 어려울 수 있습니다. 시스템 디자인에서 어떤 속성을 우선시할지 결정해야 합니다.
3. **분할 문제**  
네트워크 분할은 시스템의 일부 노드 간의 통신이 끊어진 상태를 의미합니다. 이러한 분할이 발생하면 분산 시스템은 분할된 부분에서 어떤 동작을 할 것인지 결정해야 합니다.
4. **동기화 문제**  
분산 환경에서 동시성 문제와 관련된 동기화 문제가 발생할 수 있습니다. 데이터 일관성을 유지하고 동기화를 보장하는 것이 중요합니다.
5. **보안과 인증 문제**  
분산 시스템은 보안과 인증을 신경 써야 합니다. 노드 간의 통신은 안전하고, 데이터는 보호되어야 합니다.
6. **부하 분산**  
분산 시스템은 작업 부하를 균형 있게 분산하여 성능을 최적화해야 합니다. 노드 간의 작업 분배와 관리가 중요합니다.
7. **장애 처리**  
하드웨어 또는 소프트웨어 장애는 분산 시스템에서 예상할 수 있는 문제입니다. 이러한 장애에 대한 처리 및 복구 전략이 필요합니다.
	- Partial Failure, SPOF(리더 선출 알고리즘 필요)
8. **자원 관리**  
분산 시스템에서 자원 (CPU, 메모리, 저장 공간 등)을 효과적으로 관리하고 할당하는 것이 중요합니다.
9. **확장성**  
시스템이 더 많은 노드나 자원을 추가하여 확장 가능해야 합니다. 확장성 문제는 분산 시스템의 설계 과정에서 고려되어야 합니다.
10. **모니터링과 디버깅**  
분산 시스템의 복잡성을 관리하기 위해 적절한 모니터링 및 디버깅 도구와 전략이 필요합니다.


**참고**
- [Netflix Microservice](https://www.youtube.com/watch?v=CZ3wIuvmHeM)
- [Explaining Distributed Systems Like I'm 5](https://www.youtube.com/watch?v=CESKgdNiKJw)