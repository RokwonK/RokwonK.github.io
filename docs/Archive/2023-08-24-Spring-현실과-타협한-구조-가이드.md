---
layout: default
parent: Archive
title: "Spring 현실과 타협한 패키지 구조"
categories: Spring
tags:
  - package
---  

어플리케이션을 개발 하면서 많은 고민을 하는 부분 중 하나가 패키지 구조라고 생각한다. 기능이 추가될수록 프로젝트의 복잡도는 올라가고 그에 따라 코드를 어느 패키지에 위치시킬 것인지에 대한 고민도 많이 하게된다.  

필자의 경험으로는 요구사항이 복잡해지면서 기존의 패키지 구조로는 해결하기 어려운 문제들이 생겨난다. 이를 해결하기 위해 패키지 구조를 조금씩 수정하다보면 알아보기 힘든 구조가 되어버린다.  

그렇게 여러번의 실패를 반복하며 개인적으로 현실과 타협한 패키지 구조를 구상해보았다.    

<br />  

### Base 패키지 구조
패키지 구조는 대표적으로 `Type Base`와 `Domain Base`가 존재한다.  

`Type Base`는 같은 역할별로 패키지를 나눈다.
- 어플리케이션이 커질수록 각 타입 패키지에 너무 많은 파일이 몰린다.
- 읽기 어려운 구조가 된다.

`Domain Base`는 도메인별로 패키지를 나눈다.
- 서로 다른 도메인별로 중복되는 패키지 명이 발생한다.
- 어플리케이션이 커질수록 패키지 수도 많아진다.
- 관련된 코드들이 경계가 확실한 패키지 내에 응집해 있다.


읽기 쉬운 구조를 위해 `Domain Base` 패키지 구조를 이용


### Domain Base 패키지 구조
- global
  - Domain에 종속적이지 않고 Spring에 필요한 것들
  - 모든 Domain에서 공통적으로 사용하는 것들
- domain
  - 각 도메인을 담당하는 것들
- infra
  - 인프라 레벨의 도구들과의 연동

<br /><br />

## 도메인 내 Layer 구조
1. presentation
  - controller : Client와 직접적으로 소통하는 인터페이스
2. application
  - service : 하나의 큰 요구사항을 처리하기 위한 비즈니스 로직
3. helper
  - application을 support 하는 클래스
  - 독립적인, 하나의 비즈니스로직이 될 수 없음
  - 여러 도메인에서 support 용으로 사용 가능
  - 유효성검증 로직, 복잡한 서브 비즈니스 로직, entity - dto간 변환로직 등
  - 요구사항이 복잡해지면 A 도메인에서 B 도메인을 참조하는 상황은 필연적
    - 따라서, 공유 되는 부분을 최소화하기 위한 공간으로 사용하기 좋음
4. domain (Data CRUD)
  - model
  - repository
5. exception
  - 해당 도메인에서 발생가능한 예외집합
6. common
  - 각 Layer에 종속적이지 않는 코드
  - dto
    - layer간 소통으로 각 layer별 dto를 두는 것도 좋지만 그럴 경우 리소스가 너무 많이듬(새로운 dto가 추가될 때마다 layer마다 dto가 생기므로
    - Reqeust(client에게 받는 요청객체), response(client에게 보내는 응답 객체), internal(그 외 비즈니스 로직상 사용하는 dto)
  - enum 등



**참고**
- https://americanopeople.tistory.com/372
- https://cheese10yun.github.io/spring-guide-directory/
- https://velog.io/@jsb100800/Spring-boot-directory-package
- https://laswonho.medium.com/domain-service-%EC%82%AC%EC%9A%A9%ED%95%98%EA%B8%B0-334aad46ac59