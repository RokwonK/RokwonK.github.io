---
layout: default
parent: Archive
title: "Spring 프록시 패턴"
categories: Spring
tags:
  - proxy
---  

Spring의 프록시는 AOP가 동작하는 원리이다.

프록시는 타깃에 접근하는 방법을 제어하거나, 타깃에 부가적인 기능을 부여하기위해 사용된다. 
- OCP, SRP 원칙을 지킬 수 있음
- 하지만 프록시를 일일이 구현하는 것은 코드의 복잡성이 높아지므로 동적 프록시를 이용하는 것이 좋다.


### 동적프록시
- JDK Dynamic Proxy
  - Reflection API를 사용함
  - Invocation Handler를 이용
  - Proxy 클래스를 이용해 만듬
- CGLIB
  - 바이트 코드를 조작해서 프록시를 생성한다.(런타임? 컴파일 타임?)
  - MethodInterceptor를 이용하여 부가기능을 추가
  - Enhancer 클래스를 이용해 만듬

Spring Boot는 인터페이스 기반이라도 CGLIB를 사용함(때때로 추적이 불가능하기 때문에) - 설정으로 바꿀 수는 있음

### ProxyFactoryBean
Spring에서 프록시를 Bean으로 만들어주는 객체
MethodInterceptor(위 CGLIB의 것과는 다름)를 통해 Tagget 호출  
하지만, ProxyFactoryBean 자체를 매번 코드로 생성해줘야하는 한계점이 있음 -> AOP로 이것까지 추상화

ProxyFactoryBean, Advisor, Bean postProcessor


### AOP

Advice, 어드바이저?, PointCut, 빈 후처리기, 자동 프록시 생성기