---
layout: default
parent: Archive
title: "[운영체제] 파일 시스템"
categories: CS
tags:
  - OS
  - file system
---  

## 파일 시스템
- 파일을 관리하는 시스템(저장, 삭제, 읽기를 용이하도록 관리)
- 파일에 대한 접근 제어 기능을 제공한다.
- 관리, 접근권한, 접근방법, 무결성, 백업 및 복구, 암호화  

저장 장치 내에 존재하며, 디스크 공간을 같은 크기의 블록 단위로 나누고 각 블록에 주소를 할당하여 관리한다.(파일 테이블 사용)  

<br />  

### 파일 시스템 구성
파일 시스템은 논리적인 블록으로 나누어져있다. 각 논리 블록마다 여러개의 물리 블록(섹터)을 가진다.  
- 논리블록을 크게 설정 - I/O 속도가 빠르지만 내부 단편화 발생가능
- 논리블록을 작게 설정 - 공간을 효율적으로 사용 가능하지만 속도가 느려짐

<br />  

### 리눅스 파일 시스템
여러가지 파일 시스템을 지원한다.
- 가상 파일 시스템을을 이용하여 같은 방법으로 각 파일 시스템으로 접근을 가능하게 만들어 놓았다.  
- 디렉토리와 디바이스도 파일로 취급한다.
  - 저장장치를 파티션으로 나누고 각 디렉터리마다 파일시스템을 설치, 특정 디렉토리에 마운팅

<br />  

### 리눅스 디렉토리 구조
- /proc - 프로세스와 시스템의 상태를 저장하는 의사 파일 시스템
- /usr - 리눅스 배포판이 제공하는 유틸리티 들
- /usr/local - 시스템 관리자가 제공하는 유틸리티
- /dev/console - 시스템 관리자의 콘솔의 디바이스 파일
- /dev/tty - 가상 콘솔의 디바이스 파일. 가상 콘솔(단말)을 의미함
- /dev/pts - X window system을 통한 단말의 디바이스 파일
- /dev/pty - 원격 접속을 통한 단말의 디바이스 파일

/proc, /sys, /dev, /tmp 내의 파일은 메인 메모리에 적재되어 현재 동작중인 리눅스 시스템에 대한 정보를 보유한다.

<br />  

### 리눅스 파일 시스템 구조
1. 부트 블록
  - 운영체제를 부팅시키기 위해 필요한 부트스트랩 코드
2. 슈퍼 블록
  - 파일 시스템에 대한 정보를 저장
3. 아이노드 블록
  - 하나의 파일은 반드시 하나의 아이노드를 가짐
4. 데이터 블록
  - 디렉토리 파일의 데이터 블록에는 파일명, 아이노드 번호가 존재

<br />  

### 프로세스와 파일간의 통신 - File descriptor  
- 커널에 의해 스트림에 부여되는 번호
- 파일 열기 시 3번부터 할당
- 프로세스마다 file descriptor table을 가짐
- OS는 하나의 open file table을 가지고 모든 프로세스들에 의해 열려진 파일들의 목록을 가짐


<br />  
<br />  


## 디스크에 할당하기
파일 시스템이 파일을 하드 디스크에 저장하는 방법
- 파일 시스템은 디스크 공간을 같은 크기의 블록 단위로 분할하여 관리한다.  

<br />  

### 연속할당
- 파일을 블록에 연속적으로 할당
- 외부단편화가 존재, 실제로 사용되지 않음  

<br />  

### 비연속할당
- 파일을 블록에서 비연속적으로 할당하는 기법
- Linked allocation
  - FAT
  - 파일을 구성하는 블록 포인터들의 테이블을 가짐(FAT)
  - 블록끼리 연결리스트로 연결되어 있음
- indexed allocation
  - 파일 구성하는 블록 포인터들을 저장하는 블록(index bloc)이 있음

<br />  

### 디스크 빈 공간 관리
- 디스크에 파일을 쓸 때마다 빈 공간을 찾는 것은 비효율적
- 빈 블록을 효율적으로 관리하기 위해 빈 블록들의 linked list를 유지함